# JMSv186
## サーバーを動作させるまでの流れ
### 開発環境
+ Java
    + jre-8u111-windows-x64
        + 適当に入手してください
    + jdk-8u111-nb-8_2-windows-x64
        + 適当に入手してください
    + jce_policy-8
        + AESが動作しないので以下を参考にJDK/JREのファイルを上書きしてください
            + [参考](https://qiita.com/mizuki_takahashi/items/cc26a7fd51aa04396e92)
        + アカウント作成しないとダウンロード出来ないので注意
    + NetBeans IDE 8.2
        + 適当に入手してください
+ DB
    + Wampserver2.4-x64.exe
        + 適当に入手してください
+ C++
    + Visual Studio 2017
        + 今は不要
    + Windows SDK 10.0.17763.0
        + 今は不要


### ビルド
+ このリポジトリをクローン
+ NetBeansを実行して以下の手順でビルド
    + ファイル -> 新規プロジェクト -> カテゴリ = Java, プロジェクト = 既存のソースを使用するJavaプロジェクト
    + プロジェクト名 = v186 (なんでもOK), プロジェクトフォルダ = v186.sqlがある階層のディレクトリ
    + ソース・パッケージフォルダ = src
    + 一旦プロジェクトが読み込まれるので続ける
    + 右クリックからプロパティ
    + ライブラリを選択 -> JAR/フォルダの追加 = libディレクトリに.jarファイルがあるので全て選択して追加
    + 追加したプロジェクトを右クリックしてビルド

### DB設定
+ Wampを実行
+ タスクアイコンクリックするとメニューが出るので以下をする
    + Start all Services
    + phpMyAdminを開く
+ ユーザー名root, パスワード空欄で管理画面へ入る
+ インポートを選択しv186.sqlを指定して実行ボタンを押す
+ なんかエラーが出るが無視

### サーバーの起動
+ launch_server.batを実行
    + Fully Initializedと出れば問題なし
    + クライアントが接続してくるとIoSession opened /127.0.0.1と表示される

### クライアントの準備
+ ファイル入手
    + v186のクライアントを用意
        + https://msdl.xyz/pages/jms/setups
            + 誰かがアップロードしてくれているのでそれを利用
    + [ローカル実行用ファイル](https://github.com/Riremito/JMSv186/files/6664736/RireSaba.zip)
+ 設置
    + v186クライアントをインストール
    + v186クライアントのフォルダに以下を設置
        + Riremito.dll
        + RunEmu.exe
+ 実行
    + RunEmu.exeを実行するとローカルで動作する

### サーバーの停止
+ CTRL+Cで停止するか聞かれるのでyで終了

## その他
### サーバー仕様
+ デフォルトGMアカウント
    + ID: riremito
    + ぱすわーど: riresaba
    + 2次パス: 777777
    + DB書き換えないとGMとか作れないので元から用意しておきました
+ アカウント登録
    + 自動登録
    + 2次パスは777777固定
        + 2次パス処理削除すれば不要です

### Riremito.dll
+ 多重起動防止処理の削除
+ 127.0.0.1へ接続先を変更
    + 外部公開する際に切り替える必要があるので後ほどソースをアップロードするか外部からIP指定出来るようにしておきます
+ 某アンチチートプロテクタを削除
    + アンチチート的な意味だと読み込ませたほうが良いですが、このバージョンだとOpenProcessかGetMappedFileNameA関数失敗させるだけで全ての検知処理が死ぬので意味ないです
+ メモリ改竄チェックの回避
    + メモリ書き換える都合上回避が必要になったので回避コードも入れています
    + 回避コード入れない場合は処理自体をまるごと削除することで代用可能ですが最終的にアンチチートに役立つので消さない方が良いです

### RunEmu.exe
+ Riremito.dllをインジェクトするだけのインジェクター
+ これから実行しないと普通に実行されてしまうので絶対にこれを利用すること